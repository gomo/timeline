!function(a,b){b.Timeline={},void 0===Object.create&&(Object.create=function(a,b){function c(){}var d;if("object"!=typeof a&&void 0!==a)throw new TypeError;if(c.prototype=a,d=new c,"object"==typeof b)for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);return d}),void 0===Object.getPrototypeOf&&(Object.getPrototypeOf="object"==typeof"test".__proto__?function(a){return a.__proto__}:function(a){return a.constructor.prototype}),Timeline.Util={},Timeline.Util.inherits=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype)},Timeline.View=function(){this._element=a('<div class="'+this._getClassName()+'"></div>'),this._element.appendTo("body").hide();var b={};b.view=this,this._element.data("timeline",b)},Timeline.View.prototype.getElement=function(){return this._element},Timeline.View.prototype._build=function(){},Timeline.View.prototype._postShow=function(){},Timeline.View.prototype.render=function(){return this._build(),this._element.show(),this._postShow(),this._element},Timeline.View.prototype.containsTop=function(a){var b=this._element.offset().top,c=b+this._element.outerHeight();return a>=b&&c>=a},Timeline.View.prototype.getBottom=function(){return this._element.offset().top+this._element.outerHeight()},Timeline.View.prototype.getTop=function(){return this._element.offset().top},Timeline.EventView=function(b,c){var d=this;Timeline.EventView.super_.call(d),d._timeSpan=b,d._lineView=void 0,d._nextLineView=void 0,d._element.css("position","absolute"),d._element.addClass(c),d._element.draggable({create:function(){},start:function(){d.getFrameView().getTimeIndicator().show()},stop:function(){},drag:function(a,b){d._nextLineView&&d._nextLineView.showTimeIndicator(b.helper.offset().top)}}),d._element.draggable("disable"),d._element.on("click",function(){var a={eventView:d};if(d.isFloating()){var b=d.getFrameView().getTimeIndicator().data("timeline").time,c=d.getTimeSpan().shiftStartTime(b);a.check=d._nextLineView.checkTimeSpan(c),a.lineView=d._nextLineView,d.getFrameView().triggerEvent("didClickFloatingEventView",a)}else d.isFlexible()?d.getFrameView().triggerEvent("didClickFlexibleEventView",a):d.getFrameView().triggerEvent("didClickEventView",a)}),d._element.append('<div class="start time" />'),d._displayElement=a('<div class="display" />'),d._element.append(d._displayElement),d._element.append('<div class="end time" />'),d._timesElement=d._element.find(".time"),d._timesElement.css({cursor:"default"})},Timeline.Util.inherits(Timeline.EventView,Timeline.View),Timeline.EventView.CLASS_ELEM="tlEventView",Timeline.EventView.MARGIN_SIDE=4,Timeline.EventView.create=function(a,b,c){return new Timeline.EventView(Timeline.TimeSpan.create(a,b),c)},Timeline.EventView.prototype.moveTo=function(a,b){var c=b.getSizeByTimeSpan(a),d=this._element.offset();d.top=c.top,d.left=this._getPositionLeft(b),this._element.offset(d).height(c.height),b.showTimeIndicator(d.top)},Timeline.EventView.prototype.setNextLineView=function(a){var b=this.getFrameView().swapCurrentDroppableLineView(a);b&&b.getElement().removeClass("tlEventOver"),a.getElement().addClass("tlEventOver"),a.showTimeIndicator(this._element.offset().top),this._nextLineView=a},Timeline.EventView.prototype.isFlexible=function(){return this._element.hasClass("tlFlexible")},Timeline.EventView.prototype.toFlexible=function(){this.getFrameView().getFlexibleHandle().enable(this),this._element.addClass("tlFlexible")},Timeline.EventView.prototype.floatFix=function(a){this.isFloating()&&(this.setTimeSpan(a),this._nextLineView.addEventView(this),this._clearFloat(),this.getFrameView().triggerEvent("didFixFloatingEventView",{eventView:this}))},Timeline.EventView.prototype.flexibleFix=function(){this.isFlexible()&&(this.getFrameView().getFlexibleHandle().fix(),this._element.removeClass("tlFlexible"),this.getFrameView().triggerEvent("didFixFlexibleEventView",{eventView:this}))},Timeline.EventView.prototype._clearFloat=function(){this._element.css("zIndex",99),this._element.removeClass("tlFloating"),this._element.draggable("disable"),this._nextLineView.getElement().removeClass("tlEventOver"),this._nextLineView=void 0,this.updateDisplay(),this.getFrameView().getTimeIndicator().hide()},Timeline.EventView.prototype.isFloating=function(){return this._element.hasClass("tlFloating")},Timeline.EventView.prototype.floatCancel=function(){var a=this;a.isFloating()&&(a._lineView.addEventView(a),a._clearFloat())},Timeline.EventView.prototype.flexibleCancel=function(){var a=this;a.isFlexible()&&(this.getFrameView().getFlexibleHandle().cancel(),this._element.removeClass("tlFlexible"))},Timeline.EventView.prototype.toFloat=function(){if(!this.isFloating()){var a=this._element.offset();this._element.width(this._element.width()),this._element.css("zIndex",999),this._element.offset({top:a.top+3,left:a.left+3}),this._element.addClass("tlFloating"),this._element.draggable("enable"),this.getFrameView().getElement().append(this._element),this._lineView.eachEventView(function(a,b){b.updateDisplay()}),this.setNextLineView(this._lineView),this.getFrameView().getTimeIndicator().show(),this._nextLineView.showTimeIndicator(this._element.offset().top)}},Timeline.EventView.prototype._getClassName=function(){return Timeline.EventView.CLASS_ELEM},Timeline.EventView.prototype.getFrameView=function(){return this._lineView.getFrameView()},Timeline.EventView.prototype.getTimeSpan=function(){return this._timeSpan},Timeline.EventView.prototype.setTimeSpan=function(a){return this._timeSpan=a,this},Timeline.EventView.prototype.setLineView=function(a){return this._lineView=a,this},Timeline.EventView.prototype.getLineView=function(){return this._lineView},Timeline.EventView.prototype._build=function(){this._lineView.getLineElement().append(this._element)},Timeline.EventView.prototype.updateDisplay=function(){{var a=this._lineView.getSizeByTimeSpan(this._timeSpan),b=this._element.offset();this._lineView.getLineElement().offset()}b.top=a.top,b.left=this._getPositionLeft(this._lineView),this._element.offset(b),this._element.height(a.height),this._element.outerWidth(this._lineView.getLineElement().width()-Timeline.EventView.MARGIN_SIDE),this._timesElement.filter(".start").html(this._timeSpan.getStartTime().getDisplayTime()),this._timesElement.filter(".end").html(this._timeSpan.getEndTime().getDisplayTime()),this.updateDisplayHeight()},Timeline.EventView.prototype.updateDisplayHeight=function(){this._displayElement.outerHeight(this._element.height()-2*this._timesElement.outerHeight()-4)},Timeline.EventView.prototype._getPositionLeft=function(a){var b=a.getLineElement().offset();return b.left+Timeline.EventView.MARGIN_SIDE/2},Timeline.EventView.prototype.setDisplayHtml=function(a){a instanceof jQuery?this._displayElement.children().remove().append(a):this._displayElement.html(a)},Timeline.EventView.prototype._postShow=function(){this.updateDisplay()},Timeline.FlexibleHandle=function(b){this._eventView=void 0,this._frameView=b,this._topElement=this._setupEventHandle(a('<div class="tlEventTopHandle" />')),this._downElement=this._setupEventHandle(a('<div class="tlEventDownHandle" />'))},Timeline.FlexibleHandle.MARGIN=4,Timeline.FlexibleHandle.prototype._setupEventHandle=function(a){var b=this;return a.appendTo(this._frameView.getElement()).height("30px").css({position:"absolute",zIndex:99999}).hide().data("timeline",{}).draggable({axis:"y",start:function(){b._frameView.getTimeIndicator().show()},stop:function(){var c;a.hasClass("tlEventTopHandle")?(c=b._downElement.draggable("option","containment"),b._downElement.draggable("option","containment",b._calcDownContainment(c))):a.hasClass("tlEventDownHandle")&&(c=b._topElement.draggable("option","containment"),b._topElement.draggable("option","containment",b._calcTopContainment(c)))},drag:function(c,d){var e,f=d.helper.offset(),g=b._eventView.getElement();if(a.hasClass("tlEventTopHandle"))e=f.top+d.helper.outerHeight()+Timeline.FlexibleHandle.MARGIN,g.outerHeight(g.outerHeight()+g.offset().top-e),g.offset({top:e,left:f.left});else if(a.hasClass("tlEventDownHandle")){e=f.top-Timeline.FlexibleHandle.MARGIN;var h=g.outerHeight();g.outerHeight(h+e-(g.offset().top+h))}b._eventView.getLineView().showTimeIndicator(e),b._eventView.updateDisplayHeight(),d.helper.data("timeline").time=b._frameView.getTimeIndicator().data("timeline").time}}),a},Timeline.FlexibleHandle.prototype.fix=function(){var a=new Timeline.TimeSpan(this._topElement.data("timeline").time,this._downElement.data("timeline").time);this._eventView.setTimeSpan(a),this._eventView.updateDisplay(),this._topElement.hide(),this._downElement.hide(),this._frameView.getTimeIndicator().hide()},Timeline.FlexibleHandle.prototype.cancel=function(){this._eventView.updateDisplay(),this._topElement.hide(),this._downElement.hide(),this._frameView.getTimeIndicator().hide()},Timeline.FlexibleHandle.prototype.enable=function(a){this._eventView=a,this._topElement.show(),this._downElement.show();var b=a.getElement(),c=b.offset();c.top=c.top-this._topElement.outerHeight()-Timeline.FlexibleHandle.MARGIN,this._topElement.outerWidth(b.outerWidth()),this._topElement.offset(c),this._topElement.data("timeline").time=a.getTimeSpan().getStartTime();var d=b.offset();d.top=d.top+b.outerHeight()+Timeline.FlexibleHandle.MARGIN,this._downElement.outerWidth(b.outerWidth()),this._downElement.offset(d),this._downElement.data("timeline").time=a.getTimeSpan().getEndTime();var e=a.getLineView().getPrevEventView(a.getTimeSpan().getStartTime()),f=e?e.getBottom():a.getLineView().getFirstHourView().getFirstMinView().getTop();this._topElement.draggable("option","containment",this._calcTopContainment([c.left,f-(this._topElement.outerHeight()+Timeline.FlexibleHandle.MARGIN),c.left+this._topElement.outerWidth(),void 0]));var g=a.getLineView().getNextEventView(a.getTimeSpan().getEndTime()),h=g?g.getTop():a.getLineView().getLastHourView().getLastMinView().getBottom();this._downElement.draggable("option","containment",this._calcDownContainment([d.left,void 0,d.left+this._topElement.outerWidth(),h+Timeline.FlexibleHandle.MARGIN]))},Timeline.FlexibleHandle.prototype._calcTopContainment=function(a){return a[3]=this._downElement.offset().top-this._downElement.outerHeight()-2*Timeline.FlexibleHandle.MARGIN,a},Timeline.FlexibleHandle.prototype._calcDownContainment=function(a){return a[1]=this._topElement.offset().top+this._topElement.outerHeight()+2*Timeline.FlexibleHandle.MARGIN,a},Timeline.FrameView=function(b,c){Timeline.FrameView.super_.call(this),this._linesData=c,this._timeSpan=b,this._timeLines={},this._rulerInterval=5,this._timeIndicator=a('<div id="tlTimeIndicator" />').appendTo(this._element).css({position:"absolute",zIndex:9999}).hide(),this._timeIndicator.data("timeline",{}),this._flexibleHandle=new Timeline.FlexibleHandle(this),this._currentDroppableLineView=void 0,this._defaultLineWidth=60},Timeline.Util.inherits(Timeline.FrameView,Timeline.View),Timeline.FrameView.CLASS_ELEM="tlFrameView",Timeline.FrameView.prototype._getClassName=function(){return Timeline.FrameView.CLASS_ELEM},Timeline.FrameView.prototype._build=function(){},Timeline.FrameView.prototype.swapCurrentDroppableLineView=function(a){var b=this._currentDroppableLineView;return this._currentDroppableLineView=a,b},Timeline.FrameView.prototype.setDefaultLineWidth=function(a){return this._defaultLineWidth=a,this},Timeline.FrameView.prototype.setRulerInterval=function(a){return this._rulerInterval=a,this},Timeline.FrameView.prototype.addEventListener=function(a,b){return this._element.on(a,b),this},Timeline.FrameView.prototype.triggerEvent=function(a,b){return this._element.trigger(a,[b]),this},Timeline.FrameView.prototype.getFlexibleHandle=function(){return this._flexibleHandle},Timeline.FrameView.prototype.getTimeIndicator=function(){return this._timeIndicator},Timeline.FrameView.prototype.setMinFixInterval=function(a){Timeline.MinView.FIX_INTERVAL=a},Timeline.FrameView.prototype.getMinFixInterval=function(){return Timeline.MinView.FIX_INTERVAL},Timeline.FrameView.prototype.addLineWidth=function(a){var b=0;for(var c in this._timeLines){var d=this._timeLines[c];d.addLineWidth(a),b+=d.getElement().outerWidth()}this._element.width(b)},Timeline.FrameView.prototype.addHeightPerMin=function(a){for(var b in this._timeLines){var c=this._timeLines[b];c.addHeightPerMin(a)}},Timeline.FrameView.prototype.addEventView=function(a,b){this._timeLines[a].addEventView(b)},Timeline.FrameView.prototype._postShow=function(){var b,c=this,d=0;a.each(c._linesData,function(a,e){var f=new Timeline.LineView(c._timeSpan.clone(),c._defaultLineWidth);if(f.setLabel(e.label).setId(e.id).setFrameView(c),c._timeLines[e.id])throw"Already exists timeline "+e.id;c._timeLines[e.id]=f,c._element.append(f.render()),a%c._rulerInterval===0&&(f.setRulerView(new Timeline.RulerView),b&&b.getElement().addClass("tlPrevRuler")),a%2===0?f.getElement().addClass("even"):f.getElement().addClass("odd"),d+=f.getElement().outerWidth(),b=f}),b.getElement().addClass("tlLast"),c._element.width(d)},Timeline.HourView=function(a,b,c){Timeline.HourView.super_.call(this),this._hour=b,this._minLimit=c,this._lineView=a,this._minViews=[]},Timeline.Util.inherits(Timeline.HourView,Timeline.View),Timeline.HourView.CLASS_ELEM="tlHourView",Timeline.HourView.prototype._getClassName=function(){return Timeline.HourView.CLASS_ELEM},Timeline.HourView.prototype.setLabel=function(b){if(b){var c=a('<div class="tlLabel">'+b+"</div>");this._element.append(c).addClass("tlHasLabel")}},Timeline.HourView.prototype.getFirstMinView=function(){return this._minViews[0]},Timeline.HourView.prototype.getLastMinView=function(){return this._minViews[this._minViews.length-1]},Timeline.HourView.prototype.getHour=function(){return this._hour},Timeline.HourView.prototype.getDisplayHour=function(){return this._hour<24?this._hour:this._hour-24*Math.floor(this._hour/24)},Timeline.HourView.prototype.getMinView=function(b){var c;return a.each(this._minViews,function(a,d){return d.containsMin(b)?(c=d,!1):void 0}),c},Timeline.HourView.prototype.addHeightPerMin=function(b){return a.each(this._minViews,function(a,c){c.addHeightPerMin(b)}),this},Timeline.HourView.prototype.setHeightPerMin=function(b){return a.each(this._minViews,function(a,c){c.setHeightPerMin(b)}),this},Timeline.HourView.prototype.getMinViewByTop=function(b){var c=void 0;return a.each(this._minViews,function(){return this.containsTop(b)?(c=this,!1):void 0}),c},Timeline.HourView.prototype.getLineView=function(){return this._lineView},Timeline.HourView.prototype._build=function(){for(var a=15,b=60/a,c=0;b>c;c++){var d=c*a;if(void 0!==this._minLimit&&d>this._minLimit)break;var e=new Timeline.MinView(this,d,a);this._minViews.push(e),this._element.append(e.render())}this._element.addClass("_"+this._hour)},Timeline.LineView=function(a,b){Timeline.LineView.super_.call(this),this._timeSpan=a,this._hourViews=[],this._frameView=void 0,this._lineElement=void 0,this._hoursElement=void 0,this._rulerView=void 0,this._lineWidth=b,this._label=void 0},Timeline.Util.inherits(Timeline.LineView,Timeline.View),Timeline.LineView.CLASS_ELEM="tlLineView",Timeline.LineView.prototype._getClassName=function(){return Timeline.LineView.CLASS_ELEM},Timeline.LineView.prototype.setFrameView=function(a){return this._frameView=a,this},Timeline.LineView.prototype.getFrameView=function(){return this._frameView},Timeline.LineView.prototype.checkTimeSpan=function(a){var b={ok:!0,requested:a,suggestion:a};return this.getTimeSpan().contains(a)||(a=a.shiftEndTime(this.getTimeSpan().getEndTime()),b.ok=!1,b.suggestion=a),this.eachEventView(function(c,d){if(d.getTimeSpan().contains(a))return b.ok=!1,b.suggestion=void 0,!1;if(a.overlaps(d.getTimeSpan())){if(a.getStartTime().compare(d.getTimeSpan().getStartTime())>=0)return a=a.shiftStartTime(d.getTimeSpan().getEndTime()),b.ok=!1,b.suggestion=a,!1;if(a.getEndTime().compare(d.getTimeSpan().getEndTime())<=0)return a=a.shiftEndTime(d.getTimeSpan().getStartTime()),b.ok=!1,b.suggestion=a,!1}}),this.eachEventView(function(c,d){a.overlaps(d.getTimeSpan())&&(b.ok=!1,b.suggestion=void 0)}),b},Timeline.LineView.prototype.getNextEventView=function(a){var b;return this.eachEventView(function(c,d){var e=d.getTimeSpan().getStartTime();a.compare(e)<=0&&(!b||b.getTimeSpan().getStartTime().compare(e)>0)&&(b=d)}),b},Timeline.LineView.prototype.getPrevEventView=function(a){var b;return this.eachEventView(function(c,d){var e=d.getTimeSpan().getEndTime();a.compare(e)>=0&&(!b||b.getTimeSpan().getEndTime().compare(e)<0)&&(b=d)}),b},Timeline.LineView.prototype.setLabel=function(a){return this._label=a,this},Timeline.LineView.prototype.setId=function(a){return this._element.data("timeline").id=a,this._element.addClass(a),this},Timeline.LineView.prototype.hasRulerView=function(){return!!this._rulerView},Timeline.LineView.prototype.setRulerView=function(a){this._rulerView=a,this._rulerView.setLineView(this),this._element.prepend(this._rulerView.render()),this._updateDisplay()},Timeline.LineView.prototype.eachHourView=function(b){a.each(this._hourViews,b)},Timeline.LineView.prototype.getLineElement=function(){return this._lineElement},Timeline.LineView.prototype._build=function(){var b=this;b._lineElement=a('<div class="tlTimeline" />').appendTo(b._element),b._hoursElement=a('<div class="tlHours" />').appendTo(b._lineElement),b._hoursElement.droppable({accept:".tlEventView",drop:function(a,c){var d=c.draggable.data("timeline").view;d.setNextLineView(b)},over:function(a,c){var d=c.draggable.data("timeline").view;d.setNextLineView(b)}});var c=void 0;b._timeSpan.eachHour(function(a,d,e){c=new Timeline.HourView(b,d,e),(0===a||a%5===0)&&c.setLabel(b._label),b._hoursElement.append(c.render()),b._hourViews.push(c)})},Timeline.LineView.prototype.showTimeIndicator=function(a){var b=this.getTimeByTop(a);if(b){var c=this.getFrameView().getTimeIndicator();c.data("timeline").time=b;var d=this._hoursElement.offset();d.top=a-c.height()/2,d.left=d.left-c.outerWidth(),c.offset(d),c.html(b.getDisplayTime())}},Timeline.LineView.prototype.getTimeSpan=function(){return this._timeSpan},Timeline.LineView.prototype.getTimeByTop=function(a){var b=this.getHourViewByTop(a);if(void 0===b)return void 0;var c=b.getMinViewByTop(a);return void 0===c?void 0:c.getTimeByTop(a)},Timeline.LineView.prototype.getHourViewByTop=function(b){var c=void 0;return a.each(this._hourViews,function(){return this.containsTop(b)?(c=this,!1):void 0}),c},Timeline.LineView.prototype._postShow=function(){this._updateDisplay()},Timeline.LineView.prototype.addEventView=function(a){return a.setLineView(this),a.render(),this},Timeline.LineView.prototype.getSizeByTimeSpan=function(a){var b=this._getMinView(a.getStartTime()),c=this._getMinView(a.getEndTime()),d=b.getTopByMin(a.getStartTime().getMin()),e=c.getTopByMin(a.getEndTime().getMin());return{top:d,height:e-d-1}},Timeline.LineView.prototype._getMinView=function(b){var c;return a.each(this._hourViews,function(a,d){return d.getHour()===b.getHour()?(c=d.getMinView(b.getMin()),!1):void 0}),c},Timeline.LineView.prototype.addLineWidth=function(a){return this._lineWidth+=a,this._updateDisplay(),this._updateEventsDisplay(),this},Timeline.LineView.prototype.setLineWidth=function(a){return this._lineWidth=a,this._updateDisplay(),this._updateEventsDisplay(),this},Timeline.LineView.prototype.getFirstHourView=function(){return this._hourViews[0]},Timeline.LineView.prototype.getLastHourView=function(){return this._hourViews[this._hourViews.length-1]},Timeline.LineView.prototype.addHeightPerMin=function(b){return a.each(this._hourViews,function(a,c){c.addHeightPerMin(b)}),this._updateRulerDisplay(),this._updateEventsDisplay(),this._updateDisplay(),this},Timeline.LineView.prototype.setHeightPerMin=function(b){return a.each(this._hourViews,function(a,c){c.setHeightPerMin(b)}),this._updateRulerDisplay(),this._updateEventsDisplay(),this._updateDisplay(),this},Timeline.LineView.prototype._updateDisplay=function(){var a=this;a._lineElement.width(a._lineWidth),a._rulerView?a._element.width(a._lineWidth+Timeline.RulerView.DEFAULT_WIDTH):a._element.width(a._lineWidth),setTimeout(function(){var b=a._hoursElement.height();a._lineElement.css({height:b,overflow:"hidden"})},0)},Timeline.LineView.prototype.eachEventView=function(b){this._element.find(".tlEventView:not(.ui-draggable-dragging)").each(function(c){var d=a(this).data("timeline").view;b.call(d,c,d)===!1})},Timeline.LineView.prototype._updateEventsDisplay=function(){this.eachEventView(function(a,b){b.updateDisplay()})},Timeline.LineView.prototype._updateRulerDisplay=function(){void 0!==this._rulerView&&this._rulerView.updateDisplay()},Timeline.MinView=function(a,b,c){Timeline.MinView.super_.call(this),this._hourView=a,this._min=b,this._minUnit=c,this._heightPerMin=1},Timeline.Util.inherits(Timeline.MinView,Timeline.View),Timeline.MinView.CLASS_ELEM="tlMinView",Timeline.MinView.FIX_INTERVAL=5,Timeline.MinView.prototype._getClassName=function(){return Timeline.MinView.CLASS_ELEM},Timeline.MinView.prototype.containsMin=function(a){var b=0===this._min?0:this._min,c=this._min+this._minUnit-1;return a>=b&&c>=a},Timeline.MinView.prototype.getMin=function(){return this._min},Timeline.MinView.prototype.getHourView=function(){return this._hourView},Timeline.MinView.prototype.getTopByMin=function(a){var b=this._element.offset(),c=a%this._minUnit/this._minUnit;return b.top+this._element.outerHeight()*c-1},Timeline.MinView.prototype.getTimeByTop=function(a){var b=this._min+(a-this._element.offset().top)*(this._minUnit/this._element.outerHeight());if(Timeline.MinView.FIX_INTERVAL>1){var c=b%Timeline.MinView.FIX_INTERVAL;c>Timeline.MinView.FIX_INTERVAL/2?b+=Timeline.MinView.FIX_INTERVAL-c:b-=c}return new Timeline.Time(this._hourView.getHour(),b)},Timeline.MinView.prototype.addHeightPerMin=function(a){var b=this._heightPerMin;return b+=a,.1>b&&(b=.1),this.setHeightPerMin(b),this},Timeline.MinView.prototype.setHeightPerMin=function(a){return this._heightPerMin!=a?(this._heightPerMin=a,this._updateDisplay(),this):void 0},Timeline.MinView.prototype._updateDisplay=function(){this._element.height(this._heightPerMin*this._minUnit)},Timeline.MinView.prototype._build=function(){this._element.addClass("_"+(this._min+this._minUnit)),this._updateDisplay()},Timeline.RulerView=function(){Timeline.RulerView.super_.call(this),this._lineView=void 0},Timeline.Util.inherits(Timeline.RulerView,Timeline.View),Timeline.RulerView.CLASS_ELEM="tlRulerView",Timeline.RulerView.DEFAULT_WIDTH=50,Timeline.RulerView.prototype._getClassName=function(){return Timeline.RulerView.CLASS_ELEM},Timeline.RulerView.prototype._build=function(){var b=this;b._element.width(Timeline.RulerView.DEFAULT_WIDTH),b._lineView.eachHourView(function(c,d){var e=a('<div class="hour">'+d.getDisplayHour()+":00</div>");b._element.append(e),e.data("timeline",{hourView:d}),e.css("cursor","default"),b._adjustHeight(d,e)})},Timeline.RulerView.prototype._adjustHeight=function(a,b){var c=a.getElement(),d=c.outerHeight();if(c.hasClass("tlHasLabel")){var e=c.find(".tlLabel").outerHeight();d-=e,b.css("paddingTop",e)}b.height(d)},Timeline.RulerView.prototype._postShow=function(){},Timeline.RulerView.prototype.updateDisplay=function(){var b=this;b._element.children().each(function(){var c=a(this),d=c.data("timeline").hourView;b._adjustHeight(d,c)})},Timeline.RulerView.prototype.setLineView=function(a){a.getElement().addClass("tlHasRuler"),this._lineView=a},Timeline.Time=function(a,b){for(this._hour=void 0===a?0:parseInt(a,10),this._min=void 0===b?0:parseInt(b,10);this._min<0;)--this._hour,this._min=60+this._min;for(;this._min>59;)++this._hour,this._min=this._min-60;if(this._hour<0)throw this.toString()+" is not valid time."},Timeline.Time.create=function(a){return new Timeline.Time(a[0],a[1])},Timeline.Time.prototype.getHour=function(){return this._hour},Timeline.Time.prototype.getMin=function(){return this._min},Timeline.Time.prototype.clone=function(){return new Timeline.Time(this.getHour(),this.getMin())},Timeline.Time.prototype.addMin=function(a){return new Timeline.Time(this.getHour(),this.getMin()+a)},Timeline.Time.prototype.equals=function(a){return this.getHour()===a.getHour()&&this.getMin()===a.getMin()},Timeline.Time.prototype.compare=function(a){return this.getHour()>a.getHour()?1:this.getHour()<a.getHour()?-1:this.getMin()>a.getMin()?1:this.getMin()<a.getMin()?-1:0},Timeline.Time.prototype.getDistance=function(a){var b=a.getHour(),c=b-this._hour;return 60*c+(a.getMin()-this._min)},Timeline.Time.prototype.toString=function(){return this.getDisplayTime()},Timeline.Time.prototype.getDisplayHour=function(){return this._hour<24?this._hour:this._hour-24},Timeline.Time.prototype.getDisplayMin=function(){return this._min<10?"0"+this._min:this._min},Timeline.Time.prototype.getDisplayTime=function(){return this.getDisplayHour()+":"+this.getDisplayMin()},Timeline.TimeSelector=function(b,c,d,e){var f=this;f._hourElem=b,f._minElem=c,f._minTime=d.getStartTime(),f._maxTime=d.getEndTime(),f._minInterval=e,d.eachTime(function(a,b){var c='<option value="'+b.getHour()+'">'+b.getDisplayHour()+"</option>";f._hourElem.append(c)}),a.each(Array.apply(null,{length:60/e}).map(function(a,b){return b*e}),function(a,b){var c=10>b?"0"+b:b,d='<option value="'+b+'">'+c+"</option>";f._minElem.append(d)}),f._changeCallbacks=[],f._hourElem.change(function(b){f._checkMinDisabled(),a.each(f._changeCallbacks,function(){this.call(f,b)})}),f._minElem.change(function(b){a.each(f._changeCallbacks,function(){this.call(f,b)})})},Timeline.TimeSelector.prototype.change=function(a){return this._changeCallbacks.push(a),this},Timeline.TimeSelector.prototype.getTime=function(){return new Timeline.Time(this._hourElem.val(),this._minElem.val())},Timeline.TimeSelector.prototype.setTimeWithLesserMin=function(a){var b=this;return b._hourElem.val(a.getHour()),b._minElem.val(b._minInterval*Math.floor(a.getMin()/b._minInterval)),b},Timeline.TimeSelector.prototype.setTimeWithGreaterMin=function(a){var b=this;return b._hourElem.val(a.getHour()),b._minElem.val(b._minInterval*Math.ceil(a.getMin()/b._minInterval)),b},Timeline.TimeSelector.prototype._checkMinDisabled=function(){var b=this,c=b._hourElem.val();if(b._minElem.find("option").each(function(){var b=a(this);b.removeAttr("disabled")}),b._minTime.getHour()==c){var d=b.getTime();b._minElem.find("option").each(function(){var c=a(this);c.val()<b._minTime.getMin()&&c.attr("disabled","disabled")}),d.compare(b._minTime)<0&&b.setTimeWithGreaterMin(b._minTime)}if(b._maxTime.getHour()==c){var d=b.getTime();b._minElem.find("option").each(function(){var c=a(this);c.val()>b._maxTime.getMin()&&c.attr("disabled","disabled")}),d.compare(b._maxTime)>0&&b.setTimeWithLesserMin(b._maxTime)}},Timeline.TimeSelector.prototype._checkHourDisabled=function(){var b=this;b._hourElem.find("option").each(function(){var c=a(this),d=c.val();d<b._minTime.getHour()||d>b._maxTime.getHour()?c.attr("disabled","disabled"):c.removeAttr("disabled")})},Timeline.TimeSelector.prototype.setMinTime=function(a){var b=this;b._minTime=a;var c=b.getTime();return c.compare(a)<0&&b.setTimeWithGreaterMin(a),b._checkHourDisabled(),b._checkMinDisabled(),b},Timeline.TimeSelector.prototype.setMaxTime=function(a){var b=this;b._maxTime=a;var c=b.getTime();return c.compare(a)>0&&b.setTimeWithLesserMin(a),b._checkHourDisabled(),b._checkMinDisabled(),b},Timeline.TimeSpan=function(a,b){for(;a.compare(b)>=0;)b=b.addMin(1440);this._startTime=a,this._endTime=b},Timeline.TimeSpan.create=function(a,b){return new Timeline.TimeSpan(new Timeline.Time(a[0],a[1]),new Timeline.Time(b[0],b[1]))},Timeline.TimeSpan.prototype.clone=function(){return new Timeline.TimeSpan(this.getStartTime().clone(),this.getEndTime().clone())},Timeline.TimeSpan.prototype.getDistance=function(){return this._startTime.getDistance(this._endTime)},Timeline.TimeSpan.prototype.getStartTime=function(){return this._startTime},Timeline.TimeSpan.prototype.getEndTime=function(){return this._endTime},Timeline.TimeSpan.prototype.shiftEndTime=function(a){return new Timeline.TimeSpan(a.addMin(-this.getDistance()),a)},Timeline.TimeSpan.prototype.shiftStartTime=function(a){return console.log(a),new Timeline.TimeSpan(a,a.addMin(this.getDistance()))},Timeline.TimeSpan.prototype.equals=function(a){return this.getStartTime().equals(a.getStartTime())&&this.getEndTime().equals(a.getEndTime())},Timeline.TimeSpan.prototype.contains=function(a){return this.getStartTime().compare(a.getStartTime())<=0&&this.getEndTime().compare(a.getEndTime())>=0},Timeline.TimeSpan.prototype.containsTime=function(a){return this.getStartTime().compare(a)<0&&this.getEndTime().compare(a)>0},Timeline.TimeSpan.prototype.overlaps=function(a){return a.contains(this)?!0:this.containsTime(a.getStartTime())?!0:this.containsTime(a.getEndTime())?!0:!1},Timeline.TimeSpan.prototype.eachHour=function(a){for(var b=this.getStartTime().getHour(),c=this.getEndTime().getHour(),d=0;;){if(b===c){a.call(b,d,b,this.getEndTime().getMin());break}a.call(b,d,b),b+=1,++d}},Timeline.TimeSpan.prototype.eachTime=function(a,b){var c=0;b=b?b:60;for(var d=this.getStartTime();;){if(d.compare(this.getEndTime())>0)break;a.call(d,c,d),d=d.addMin(b),++c}},Timeline.TimeSpan.prototype.toString=function(){return this._startTime+"~"+this._endTime}}(jQuery,function(){return this}());