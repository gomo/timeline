(function(a){Timeline={};if(Object.create===undefined){Object.create=function(e,c){var b;if(typeof(e)!=="object"&&e!==null){throw new TypeError()}function d(){}d.prototype=e;b=new d();if(typeof(c)==="object"){for(var f in c){if(c.hasOwnProperty((f))){b[f]=c[f]}}}return b}}if(Object.getPrototypeOf===undefined){if(typeof"test".__proto__==="object"){Object.getPrototypeOf=function(b){return b.__proto__}}else{Object.getPrototypeOf=function(b){return b.constructor.prototype}}}Timeline.Util={};Timeline.Util.inherits=function(b,c){b.super_=c;b.prototype=Object.create(c.prototype)};Timeline.View=function(){this._element=a('<div class="'+this._getClassName()+'"></div>');this._element.appendTo("body").hide();var b={};b.view=this;this._element.data("timeline",b)};Timeline.View.prototype.getElement=function(){return this._element};Timeline.View.prototype._build=function(){};Timeline.View.prototype._postShow=function(){};Timeline.View.prototype.render=function(){this._build();this._element.show();this._postShow();return this._element};Timeline.View.prototype.containsTop=function(c){var b=this._element.offset().top;var d=b+this._element.outerHeight();return b<=c&&c<=d};Timeline.View.prototype.getBottom=function(){return this._element.offset().top+this._element.outerHeight()};Timeline.View.prototype.getTop=function(){return this._element.offset().top};Timeline.EventView=function(e,d){var c=this;Timeline.EventView.super_.call(c);c._timeSpan=e;c._lineView=null;c._nextLineView=null;c._element.css("position","absolute");c._element.addClass(d);var b=null;c._element.draggable({create:function(f,g){},start:function(f,g){c.getFrameView().getTimeIndicator().show()},stop:function(f,g){},drag:function(f,g){if(c._nextLineView){c._nextLineView.showTimeIndicator(g.helper.offset().top)}}});c._element.draggable("disable");c._element.on("click",function(h){var i={eventView:c};if(c.isFloating()){var g=c.getFrameView().getTimeIndicator().data("timeline").time;var f=c.getTimeSpan().shiftStartTime(g);i.check=c._nextLineView.checkTimeSpan(f);i.lineView=c._nextLineView;c.getFrameView().triggerEvent("didClickFloatingEventView",i)}else{if(c.isFlexible()){c.getFrameView().triggerEvent("didClickFlexibleEventView",i)}else{c.getFrameView().triggerEvent("didClickEventView",i)}}});c._element.append('<div class="start time" />');c._displayElement=a('<div class="display" />');c._element.append(c._displayElement);c._element.append('<div class="end time" />');c._timesElement=c._element.find(".time");c._timesElement.css({cursor:"default"})};Timeline.Util.inherits(Timeline.EventView,Timeline.View);Timeline.EventView.CLASS_ELEM="tlEventView";Timeline.EventView.MARGIN_SIDE=4;Timeline.EventView.create=function(d,b,c){return new Timeline.EventView(Timeline.TimeSpan.create(d,b),c)};Timeline.EventView.prototype.moveTo=function(d,c){var b=c.getSizeByTimeSpan(d);var e=this._element.offset();e.top=b.top;e.left=this._getPositionLeft(c);this._element.offset(e).height(b.height);c.showTimeIndicator(e.top)};Timeline.EventView.prototype.setNextLineView=function(b){if(this._nextLineView){this._nextLineView.getElement().removeClass("tlEventOver")}b.getElement().addClass("tlEventOver");b.showTimeIndicator(this._element.offset().top);this._nextLineView=b};Timeline.EventView.prototype.isFlexible=function(){return this._element.hasClass("tlFlexible")};Timeline.EventView.prototype.toFlexible=function(){this.getFrameView().getFlexibleHandle().enable(this);this._element.addClass("tlFlexible")};Timeline.EventView.prototype.floatFix=function(b){if(this.isFloating()){this.setTimeSpan(b);this._nextLineView.addEventView(this);this._clearFloat();this.getFrameView().triggerEvent("didFixFloatingEventView",{eventView:this})}};Timeline.EventView.prototype.flexibleFix=function(b){if(this.isFlexible()){this.getFrameView().getFlexibleHandle().fix();this._element.removeClass("tlFlexible");this.getFrameView().triggerEvent("didFixFlexibleEventView",{eventView:this})}};Timeline.EventView.prototype._clearFloat=function(){this._element.css("zIndex",99);this._element.removeClass("tlFloating");this._element.draggable("disable");this._nextLineView.getElement().removeClass("tlEventOver");this._nextLineView=null;this.updateDisplay();this.getFrameView().getTimeIndicator().hide()};Timeline.EventView.prototype.isFloating=function(){return this._element.hasClass("tlFloating")};Timeline.EventView.prototype.floatCancel=function(){var b=this;if(b.isFloating()){b._lineView.addEventView(b);b._clearFloat()}};Timeline.EventView.prototype.flexibleCancel=function(){var b=this;if(b.isFlexible()){this.getFrameView().getFlexibleHandle().cancel();this._element.removeClass("tlFlexible")}};Timeline.EventView.prototype.toFloat=function(){if(this.isFloating()){return}var b=this._element.offset();this._element.width(this._element.width());this._element.css("zIndex",999);this._element.offset({top:b.top+3,left:b.left+3});this._element.addClass("tlFloating");this._element.draggable("enable");this.getFrameView().getElement().append(this._element);this._lineView.eachEventView(function(d,c){c.updateDisplay()});this.setNextLineView(this._lineView);this.getFrameView().getTimeIndicator().show();this._nextLineView.showTimeIndicator(this._element.offset().top)};Timeline.EventView.prototype._getClassName=function(){return Timeline.EventView.CLASS_ELEM};Timeline.EventView.prototype.getFrameView=function(){return this._lineView.getFrameView()};Timeline.EventView.prototype.getTimeSpan=function(){return this._timeSpan};Timeline.EventView.prototype.setTimeSpan=function(b){this._timeSpan=b;return this};Timeline.EventView.prototype.setLineView=function(b){this._lineView=b;return this};Timeline.EventView.prototype.getLineView=function(b){return this._lineView};Timeline.EventView.prototype._build=function(){this._lineView.getLineElement().append(this._element)};Timeline.EventView.prototype.updateDisplay=function(){var c=this._lineView.getSizeByTimeSpan(this._timeSpan);var d=this._element.offset();var b=this._lineView.getLineElement().offset();d.top=c.top;d.left=this._getPositionLeft(this._lineView);this._element.offset(d);this._element.height(c.height);this._element.outerWidth(this._lineView.getLineElement().width()-Timeline.EventView.MARGIN_SIDE);this._timesElement.filter(".start").html(this._timeSpan.getStartTime().getDisplayTime());this._timesElement.filter(".end").html(this._timeSpan.getEndTime().getDisplayTime());this.updateDisplayHeight()};Timeline.EventView.prototype.updateDisplayHeight=function(b){this._displayElement.outerHeight(this._element.height()-(this._timesElement.outerHeight()*2)-4)};Timeline.EventView.prototype._getPositionLeft=function(c){var b=c.getLineElement().offset();return b.left+(Timeline.EventView.MARGIN_SIDE/2)};Timeline.EventView.prototype.setDisplayHtml=function(b){if(b instanceof jQuery){this._displayElement.children().remove().append(b)}else{this._displayElement.html(b)}};Timeline.EventView.prototype._postShow=function(){this.updateDisplay()};Timeline.FlexibleHandle=function(b){this._eventView=null;this._frameView=b;this._topElement=this._setupEventHandle(a('<div class="tlEventTopHandle" />'));this._downElement=this._setupEventHandle(a('<div class="tlEventDownHandle" />'))};Timeline.FlexibleHandle.MARGIN=4;Timeline.FlexibleHandle.prototype._setupEventHandle=function(c){var b=this;c.appendTo(this._frameView.getElement()).height("30px").css({position:"absolute",zIndex:99999}).hide().data("timeline",{}).draggable({axis:"y",start:function(d,e){b._frameView.getTimeIndicator().show()},stop:function(d,e){var f;if(c.hasClass("tlEventTopHandle")){f=b._downElement.draggable("option","containment");b._downElement.draggable("option","containment",b._calcDownContainment(f))}else{if(c.hasClass("tlEventDownHandle")){f=b._topElement.draggable("option","containment");b._topElement.draggable("option","containment",b._calcTopContainment(f))}}},drag:function(g,h){var i=h.helper.offset();var f=b._eventView.getElement();var e;if(c.hasClass("tlEventTopHandle")){e=i.top+h.helper.outerHeight()+Timeline.FlexibleHandle.MARGIN;f.outerHeight(f.outerHeight()+f.offset().top-e);f.offset({top:e,left:i.left})}else{if(c.hasClass("tlEventDownHandle")){e=i.top-Timeline.FlexibleHandle.MARGIN;var d=f.outerHeight();f.outerHeight(d+e-(f.offset().top+d))}}b._eventView.getLineView().showTimeIndicator(e);b._eventView.updateDisplayHeight();h.helper.data("timeline").time=b._frameView.getTimeIndicator().data("timeline").time}});return c};Timeline.FlexibleHandle.prototype.fix=function(){var b=new Timeline.TimeSpan(this._topElement.data("timeline").time,this._downElement.data("timeline").time);this._eventView.setTimeSpan(b);this._eventView.updateDisplay();this._topElement.hide();this._downElement.hide();this._frameView.getTimeIndicator().hide()};Timeline.FlexibleHandle.prototype.cancel=function(){this._eventView.updateDisplay();this._topElement.hide();this._downElement.hide();this._frameView.getTimeIndicator().hide()};Timeline.FlexibleHandle.prototype.enable=function(b){this._eventView=b;this._topElement.show();this._downElement.show();var h=b.getElement();var g=h.offset();g.top=g.top-this._topElement.outerHeight()-Timeline.FlexibleHandle.MARGIN;this._topElement.outerWidth(h.outerWidth());this._topElement.offset(g);this._topElement.data("timeline").time=b.getTimeSpan().getStartTime();var f=h.offset();f.top=f.top+h.outerHeight()+Timeline.FlexibleHandle.MARGIN;this._downElement.outerWidth(h.outerWidth());this._downElement.offset(f);this._downElement.data("timeline").time=b.getTimeSpan().getEndTime();var i=b.getLineView().getPrevEventView(b.getTimeSpan().getStartTime());var c=i?i.getBottom():b.getLineView().getFirstHourView().getFirstMinView().getTop();this._topElement.draggable("option","containment",this._calcTopContainment([g.left,c-(this._topElement.outerHeight()+Timeline.FlexibleHandle.MARGIN),g.left+this._topElement.outerWidth(),undefined]));var d=b.getLineView().getNextEventView(b.getTimeSpan().getEndTime());var e=d?d.getTop():b.getLineView().getLastHourView().getLastMinView().getBottom();this._downElement.draggable("option","containment",this._calcDownContainment([f.left,undefined,f.left+this._topElement.outerWidth(),e+Timeline.FlexibleHandle.MARGIN]))};Timeline.FlexibleHandle.prototype._calcTopContainment=function(b){b[3]=this._downElement.offset().top-this._downElement.outerHeight()-(Timeline.FlexibleHandle.MARGIN*2);return b};Timeline.FlexibleHandle.prototype._calcDownContainment=function(b){b[1]=this._topElement.offset().top+this._topElement.outerHeight()+(Timeline.FlexibleHandle.MARGIN*2);return b};Timeline.FrameView=function(c,b){Timeline.FrameView.super_.call(this);this._linesData=b;this._timeSpan=c;this._timeLines={};this._rulerInterval=5;this._timeIndicator=a('<div id="tlTimeIndicator" />').appendTo(this._element).css({position:"absolute",zIndex:9999}).hide();this._timeIndicator.data("timeline",{});this._flexibleHandle=new Timeline.FlexibleHandle(this)};Timeline.Util.inherits(Timeline.FrameView,Timeline.View);Timeline.FrameView.CLASS_ELEM="tlFrameView";Timeline.FrameView.prototype._getClassName=function(){return Timeline.FrameView.CLASS_ELEM};Timeline.FrameView.prototype._build=function(){};Timeline.FrameView.prototype.addEventListener=function(b,c){this._element.on(b,c);return this};Timeline.FrameView.prototype.triggerEvent=function(b,c){this._element.trigger(b,[c]);return this};Timeline.FrameView.prototype.getFlexibleHandle=function(){return this._flexibleHandle};Timeline.FrameView.prototype.getTimeIndicator=function(){return this._timeIndicator};Timeline.FrameView.prototype.setMinFixInterval=function(b){Timeline.MinView.FIX_INTERVAL=b};Timeline.FrameView.prototype.getMinFixInterval=function(){return Timeline.MinView.FIX_INTERVAL};Timeline.FrameView.prototype.addLineWidth=function(d){for(var c in this._timeLines){var b=this._timeLines[c];b.addLineWidth(d)}};Timeline.FrameView.prototype.addHeightPerMin=function(d){for(var c in this._timeLines){var b=this._timeLines[c];b.addHeightPerMin(d)}};Timeline.FrameView.prototype.addEventView=function(c,b){this._timeLines[c].addEventView(b)};Timeline.FrameView.prototype._postShow=function(){var d=this;var b=0;var c;a.each(d._linesData,function(e,g){var f=new Timeline.LineView(d._timeSpan.clone());f.setLabel(g.label).setId(g.id).setFrameView(d);if(d._timeLines[g.id]){throw"Already exists timeline "+g.id}d._timeLines[g.id]=f;d._element.append(f.render());if(e%d._rulerInterval===0){f.setRulerView(new Timeline.RulerView());if(c){c.getElement().addClass("tlPrevRuler")}}if(e%2===0){f.getElement().addClass("even")}else{f.getElement().addClass("odd")}b+=f.getElement().outerWidth();c=f});d._element.width(b)};Timeline.HourView=function(d,c,b){Timeline.HourView.super_.call(this);this._hour=c;this._minLimit=b;this._lineView=d;this._minViews=[]};Timeline.Util.inherits(Timeline.HourView,Timeline.View);Timeline.HourView.CLASS_ELEM="tlHourView";Timeline.HourView.prototype._getClassName=function(){return Timeline.HourView.CLASS_ELEM};Timeline.HourView.prototype.setLabel=function(b){if(b){var c=a('<div class="tlLabel">'+b+"</div>");this._element.append(c).addClass("tlHasLabel")}};Timeline.HourView.prototype.getFirstMinView=function(){return this._minViews[0]};Timeline.HourView.prototype.getLastMinView=function(){return this._minViews[this._minViews.length-1]};Timeline.HourView.prototype.getHour=function(){return this._hour};Timeline.HourView.prototype.getDisplayHour=function(){return this._hour<24?this._hour:this._hour-24};Timeline.HourView.prototype.getMinView=function(c){var b;a.each(this._minViews,function(d,e){if(e.containsMin(c)){b=e;return false}});return b};Timeline.HourView.prototype.addHeightPerMin=function(b){a.each(this._minViews,function(c,d){d.addHeightPerMin(b)});return this};Timeline.HourView.prototype.setHeightPerMin=function(b){a.each(this._minViews,function(c,d){d.setHeightPerMin(b)});return this};Timeline.HourView.prototype.getMinViewByTop=function(c){var b=null;a.each(this._minViews,function(){if(this.containsTop(c)){b=this;return false}});return b};Timeline.HourView.prototype.getLineView=function(){return this._lineView};Timeline.HourView.prototype._build=function(){var f=15;var e=60/f;for(var d=0;d<e;d++){var b=d*f;if(this._minLimit!==undefined&&b>this._minLimit){break}var c=new Timeline.MinView(this,b,f);this._minViews.push(c);this._element.append(c.render())}this._element.addClass("_"+this._hour)};Timeline.LineView=function(b){Timeline.LineView.super_.call(this);this._timeSpan=b;this._hourViews=[];this._frameView=null;this._lineElement=null;this._hoursElement=null;this._rulerView=null;this._lineWidth=60;this._label=undefined};Timeline.Util.inherits(Timeline.LineView,Timeline.View);Timeline.LineView.CLASS_ELEM="tlLineView";Timeline.LineView.prototype._getClassName=function(){return Timeline.LineView.CLASS_ELEM};Timeline.LineView.prototype.setFrameView=function(b){this._frameView=b;return this};Timeline.LineView.prototype.getFrameView=function(){return this._frameView};Timeline.LineView.prototype.checkTimeSpan=function(f){var b={ok:true,requested:f,suggestion:f,space:undefined};if(f.overlapsTimeSpan(this.getTimeSpan())===Timeline.TimeSpan.OVERLAP_END){f=f.shiftStartTime(this.getTimeSpan().getStartTime());b.ok=false;b.suggestion=f}if(f.overlapsTimeSpan(this.getTimeSpan())===Timeline.TimeSpan.OVERLAP_START){f=f.shiftEndTime(this.getTimeSpan().getEndTime());b.ok=false;b.suggestion=f}this.eachEventView(function(h,g){if(f.overlapsTimeSpan(g.getTimeSpan())===Timeline.TimeSpan.OVERLAP_START){f=f.shiftStartTime(g.getTimeSpan().getEndTime());b.ok=false;b.suggestion=f;return false}});var e=f.getStartTime();var c=this.getNextEventView(e);if(c){b.space=new Timeline.TimeSpan(e,c.getTimeSpan().getStartTime());var d=f.overlapsTimeSpan(b.space);if(d!==Timeline.TimeSpan.OVERLAP_CONTAIN&&d!==Timeline.TimeSpan.OVERLAP_EQUAL){b.suggestion=undefined}}else{b.space=new Timeline.TimeSpan(e,this.getTimeSpan().getEndTime())}return b};Timeline.LineView.prototype.getNextEventView=function(c){var b;this.eachEventView(function(e,d){var f=d.getTimeSpan().getStartTime();if(c.compare(f)<=0){if(!b||b.getTimeSpan().getStartTime().compare(f)>0){b=d}}});return b};Timeline.LineView.prototype.getPrevEventView=function(c){var b;this.eachEventView(function(e,d){var f=d.getTimeSpan().getEndTime();if(c.compare(f)>=0){if(!b||b.getTimeSpan().getEndTime().compare(f)<0){b=d}}});return b};Timeline.LineView.prototype.setLabel=function(b){this._label=b;return this};Timeline.LineView.prototype.setId=function(b){this._element.data("timeline").id=b;this._element.addClass(b);return this};Timeline.LineView.prototype.hasRulerView=function(){return !!this._rulerView};Timeline.LineView.prototype.setRulerView=function(b){this._rulerView=b;this._rulerView.setLineView(this);this._element.prepend(this._rulerView.render());this._updateDisplay()};Timeline.LineView.prototype.eachHourView=function(b){a.each(this._hourViews,b)};Timeline.LineView.prototype.getLineElement=function(){return this._lineElement};Timeline.LineView.prototype._build=function(){var b=this;b._lineElement=a('<div class="tlTimeline" />').appendTo(b._element);b._hoursElement=a('<div class="tlHours" />').appendTo(b._lineElement);b._hoursElement.droppable({accept:".tlEventView",drop:function(e,f){var d=f.draggable.data("timeline").view;d.setNextLineView(b)},over:function(e,f){var d=f.draggable.data("timeline").view;d.setNextLineView(b)}});var c=null;b._timeSpan.eachHour(function(f,e,d){c=new Timeline.HourView(b,e,d);if(f===0||f%5===0){c.setLabel(b._label)}b._hoursElement.append(c.render());b._hourViews.push(c)})};Timeline.LineView.prototype.showTimeIndicator=function(d){var c=this.getTimeByTop(d);if(c){var b=this.getFrameView().getTimeIndicator();b.data("timeline").time=c;var e=this._hoursElement.offset();e.top=d-(b.height()/2);e.left=e.left-b.outerWidth();b.offset(e);b.html(c.getDisplayTime())}};Timeline.LineView.prototype.getTimeSpan=function(){return this._timeSpan};Timeline.LineView.prototype.getTimeByTop=function(d){var c=this.getHourViewByTop(d);if(c===null){return null}var b=c.getMinViewByTop(d);if(b===null){return null}return b.getTimeByTop(d)};Timeline.LineView.prototype.getHourViewByTop=function(c){var b=null;a.each(this._hourViews,function(){if(this.containsTop(c)){b=this;return false}});return b};Timeline.LineView.prototype._postShow=function(){this._updateDisplay()};Timeline.LineView.prototype.addEventView=function(b){b.setLineView(this);b.render();return this};Timeline.LineView.prototype.getSizeByTimeSpan=function(f){var e=this._getMinView(f.getStartTime());var d=this._getMinView(f.getEndTime());var c=e.getTopByMin(f.getStartTime().getMin());var b=d.getTopByMin(f.getEndTime().getMin());return{top:c,height:b-c-1}};Timeline.LineView.prototype._getMinView=function(c){var b;a.each(this._hourViews,function(d,e){if(e.getHour()===c.getHour()){b=e.getMinView(c.getMin());return false}});return b};Timeline.LineView.prototype.addLineWidth=function(b){this._lineWidth+=b;this._updateDisplay();this._updateEventsDisplay();return this};Timeline.LineView.prototype.setLineWidth=function(b){this._lineWidth=b;this._updateDisplay();this._updateEventsDisplay();return this};Timeline.LineView.prototype.getFirstHourView=function(){return this._hourViews[0]};Timeline.LineView.prototype.getLastHourView=function(){return this._hourViews[this._hourViews.length-1]};Timeline.LineView.prototype.addHeightPerMin=function(b){a.each(this._hourViews,function(c,d){d.addHeightPerMin(b)});this._updateRulerDisplay();this._updateEventsDisplay();this._updateDisplay();return this};Timeline.LineView.prototype.setHeightPerMin=function(b){a.each(this._hourViews,function(c,d){d.setHeightPerMin(b)});this._updateRulerDisplay();this._updateEventsDisplay();this._updateDisplay();return this};Timeline.LineView.prototype._updateDisplay=function(){var b=this;b._lineElement.width(b._lineWidth);if(b._rulerView){b._element.width(b._lineWidth+Timeline.RulerView.DEFAULT_WIDTH)}else{b._element.width(b._lineWidth)}setTimeout(function(){var c=b._hoursElement.height();b._lineElement.css({height:c,overflow:"hidden"})},0)};Timeline.LineView.prototype.eachEventView=function(b){this._element.find(".tlEventView:not(.ui-draggable-dragging)").each(function(d){var c=a(this).data("timeline").view;if(b.call(c,d,c)===false){return}})};Timeline.LineView.prototype._updateEventsDisplay=function(){this.eachEventView(function(c,b){b.updateDisplay()})};Timeline.LineView.prototype._updateRulerDisplay=function(){if(this._rulerView===null){return}this._rulerView.updateDisplay()};Timeline.MinView=function(c,b,d){Timeline.MinView.super_.call(this);this._hourView=c;this._min=b;this._minUnit=d;this._heightPerMin=1};Timeline.Util.inherits(Timeline.MinView,Timeline.View);Timeline.MinView.CLASS_ELEM="tlMinView";Timeline.MinView.FIX_INTERVAL=5;Timeline.MinView.prototype._getClassName=function(){return Timeline.MinView.CLASS_ELEM};Timeline.MinView.prototype.containsMin=function(d){var c=this._min===0?0:this._min;var b=this._min+this._minUnit-1;return c<=d&&d<=b};Timeline.MinView.prototype.getMin=function(){return this._min};Timeline.MinView.prototype.getHourView=function(){return this._hourView};Timeline.MinView.prototype.getTopByMin=function(b){var d=this._element.offset();var c=(b%this._minUnit)/this._minUnit;return d.top+(this._element.outerHeight()*c)-1};Timeline.MinView.prototype.getTimeByTop=function(c){var b=this._min+((c-this._element.offset().top)*(this._minUnit/this._element.outerHeight()));if(Timeline.MinView.FIX_INTERVAL>1){var d=b%Timeline.MinView.FIX_INTERVAL;if(d>Timeline.MinView.FIX_INTERVAL/2){b+=Timeline.MinView.FIX_INTERVAL-d}else{b-=d}}return new Timeline.Time(this._hourView.getHour(),b)};Timeline.MinView.prototype.addHeightPerMin=function(b){var c=this._heightPerMin;c+=b;if(c<0.1){c=0.1}this.setHeightPerMin(c);return this};Timeline.MinView.prototype.setHeightPerMin=function(b){if(this._heightPerMin==b){return}this._heightPerMin=b;this._updateDisplay();return this};Timeline.MinView.prototype._updateDisplay=function(){this._element.height(this._heightPerMin*this._minUnit)};Timeline.MinView.prototype._build=function(){this._element.addClass("_"+(this._min+this._minUnit));this._updateDisplay()};Timeline.RulerView=function(){Timeline.RulerView.super_.call(this);this._lineView=null};Timeline.Util.inherits(Timeline.RulerView,Timeline.View);Timeline.RulerView.CLASS_ELEM="tlRulerView";Timeline.RulerView.DEFAULT_WIDTH=50;Timeline.RulerView.prototype._getClassName=function(){return Timeline.RulerView.CLASS_ELEM};Timeline.RulerView.prototype._build=function(){var b=this;b._element.width(Timeline.RulerView.DEFAULT_WIDTH);b._lineView.eachHourView(function(d,e){var c=a('<div class="hour">'+e.getDisplayHour()+":00</div>");b._element.append(c);c.data("timeline",{hourView:e});c.css("cursor","default");b._adjustHeight(e,c)})};Timeline.RulerView.prototype._adjustHeight=function(d,c){var f=d.getElement();var b=f.outerHeight();if(f.hasClass("tlHasLabel")){var e=f.find(".tlLabel").outerHeight();b-=e;c.css("paddingTop",e)}c.height(b)};Timeline.RulerView.prototype._postShow=function(){};Timeline.RulerView.prototype.updateDisplay=function(){var b=this;b._element.children().each(function(){var c=a(this);var d=c.data("timeline").hourView;b._adjustHeight(d,c)})};Timeline.RulerView.prototype.setLineView=function(b){b.getElement().addClass("tlHasRuler");this._lineView=b};Timeline.Time=function(b,c){this._hour=b===undefined?0:parseInt(b,10);this._min=c===undefined?0:parseInt(c,10);if(this._min<0){--this._hour;this._min=60+this._min}if(this._min>59){++this._hour;this._min=this._min-60}if(this._hour<0){throw this.toString()+" is not valid time."}};Timeline.Time.create=function(b,c){return new Timeline.Time(b,c)};Timeline.Time.prototype.getHour=function(){return this._hour};Timeline.Time.prototype.getMin=function(){return this._min};Timeline.Time.prototype.clone=function(){return new Timeline.Time(this.getHour(),this.getMin())};Timeline.Time.prototype.addMin=function(d){var f=this.getHour();var e=this.getMin();e+=d;if(e>59){var c=Math.floor(e/60);f+=c;e=Math.abs(e%60)}else{if(e<0){var b=Math.floor(e/60);f+=b;e=60-Math.abs(e%60);if(e===60){e=0}}}return new Timeline.Time(f,e)};Timeline.Time.prototype.isEqual=function(b){return this.getHour()===b.getHour()&&this.getMin()===b.getMin()};Timeline.Time.prototype.compare=function(b){if(this.getHour()>b.getHour()){return 1}else{if(this.getHour()<b.getHour()){return -1}else{if(this.getMin()>b.getMin()){return 1}else{if(this.getMin()<b.getMin()){return -1}}}}return 0};Timeline.Time.prototype.getDistance=function(d){var c=d.getHour();var b=c-this._hour;return(b*60)+(d.getMin()-this._min)};Timeline.Time.prototype.toString=function(){return this._hour+":"+(this._min<10?"0"+this._min:this._min)};Timeline.Time.prototype.getDisplayHour=function(){return this._hour<24?this._hour:this._hour-24};Timeline.Time.prototype.getDisplayTime=function(){return this.getDisplayHour()+":"+(this._min<10?"0"+this._min:this._min)};Timeline.TimeSpan=function(c,b){if(c.compare(b)>0){throw"The endTime is earlier than the startTime."}this._startTime=c;this._endTime=b};Timeline.TimeSpan.OVERLAP_NO=0;Timeline.TimeSpan.OVERLAP_START=1;Timeline.TimeSpan.OVERLAP_END=2;Timeline.TimeSpan.OVERLAP_CONTAIN=3;Timeline.TimeSpan.OVERLAP_OVER=4;Timeline.TimeSpan.OVERLAP_EQUAL=5;Timeline.TimeSpan.create=function(c,b){return new Timeline.TimeSpan(new Timeline.Time(c[0],c[1]),new Timeline.Time(b[0],b[1]))};Timeline.TimeSpan.prototype.clone=function(){return new Timeline.TimeSpan(this.getStartTime().clone(),this.getEndTime().clone())};Timeline.TimeSpan.prototype.getDistance=function(){return this._startTime.getDistance(this._endTime)};Timeline.TimeSpan.prototype.getStartTime=function(){return this._startTime};Timeline.TimeSpan.prototype.getEndTime=function(){return this._endTime};Timeline.TimeSpan.prototype.shiftEndTime=function(b){return new Timeline.TimeSpan(b.addMin(-this.getDistance()),b)};Timeline.TimeSpan.prototype.shiftStartTime=function(b){return new Timeline.TimeSpan(b,b.addMin(this.getDistance()))};Timeline.TimeSpan.prototype.overlapsTimeSpan=function(e){var d=this._startTime.compare(e.getStartTime());var b=this._endTime.compare(e.getEndTime());if(d===0&&b===0){return Timeline.TimeSpan.OVERLAP_EQUAL}if(d<0&&b>0){return Timeline.TimeSpan.OVERLAP_OVER}var c=(this._startTime.compare(e.getStartTime())>=0&&this._startTime.compare(e.getEndTime())<0);var f=(this._endTime.compare(e.getStartTime())>0&&this._endTime.compare(e.getEndTime())<=0);if(c&&f){return Timeline.TimeSpan.OVERLAP_CONTAIN}else{if(c){return Timeline.TimeSpan.OVERLAP_START}else{if(f){return Timeline.TimeSpan.OVERLAP_END}else{return Timeline.TimeSpan.OVERLAP_NO}}}};Timeline.TimeSpan.prototype.eachHour=function(e){var c=this.getStartTime().getHour();var b=this.getEndTime().getHour();var d=0;while(true){if(c===b){e.call(c,d,c,this.getEndTime().getMin());break}else{e.call(c,d,c)}c+=1;++d}};Timeline.TimeSpan.prototype.toString=function(){return this._startTime+"~"+this._endTime}})(jQuery);